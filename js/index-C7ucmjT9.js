import{r as e,R as t,j as n,c as o,$ as s,a}from"./index-DFQQVGqn.js";import{m as r,c,w as i}from"./with-default-props-hTfmHIKB.js";import{A as l}from"./avatar-Cl5IWl0e.js";import{u,s as d,a as m,I as f,F as p}from"./index-DHQ8_N0v.js";import{u as h,a as v,b as g}from"./use-gesture-react.esm-B3uP-op0.js";import{b as _}from"./bound-q8OY5ieV.js";import{_ as b}from"./tslib.es6-DCqr_S89.js";import{u as y}from"./use-props-value-DmcGk6JE.js";import"./useCustomNavigate-rXpcffro.js";const j="adm-page-indicator",x={color:"primary",direction:"horizontal"},w=e.memo((e=>{const n=r(x,e),o=[];for(let s=0;s<n.total;s++)o.push(t.createElement("div",{key:s,className:c("".concat(j,"-dot"),{["".concat(j,"-dot-active")]:n.current===s})}));return i(n,t.createElement("div",{className:c(j,"".concat(j,"-").concat(n.direction),"".concat(j,"-color-").concat(n.color))},o))})),N=e=>i(e,t.createElement("div",{className:"adm-swiper-item",onClick:e.onClick},e.children));const k="adm-swiper",z={mousedown:"onMouseDown",mousemove:"onMouseMove",mouseup:"onMouseUp"},E={defaultIndex:0,allowTouchMove:!0,autoplay:!1,autoplayInterval:3e3,loop:!1,direction:"horizontal",slideSize:100,trackOffset:0,stuckAtBoundary:!0,rubberband:!0,stopPropagation:[]};let S;function C(e,t){const n=e%t;return n<0?n+t:n}const M=m(e.forwardRef(d(((n,o)=>{const s=r(E,n),{direction:a,total:l,children:d,indicator:m}=s,[f]=e.useState({}),p=e.useRef(null),j="vertical"===a,x=s.slideSize/100,M=s.trackOffset/100,{validChildren:R,count:I,renderChildren:O}=e.useMemo((()=>{let e,n,o=0;return"function"==typeof d?e=d:n=t.Children.map(d,(e=>t.isValidElement(e)?e.type!==N?null:(o++,e):null)),{renderChildren:e,validChildren:n,count:o}}),[d]),T=null!=l?l:I;return 0===T||!R&&!O?null:()=>{let n=s.loop;x*(T-1)<1&&(n=!1);const r=e.useRef(null);function d(){const e=r.current;if(!e)return 0;return(j?e.offsetHeight:e.offsetWidth)*s.slideSize/100}const[N,E,I]=(P=s.defaultIndex,A=b(e.useState(P),2),L=A[0],B=A[1],F=u(L),[L,B,e.useCallback((function(){return F.current}),[])]);var P,A,L,B,F;const[H,q,D]=function(t){const[n,o]=e.useState(t),s=e.useRef(n);return e.useEffect((()=>{s.current=n}),[n]),[n,o,s]}(!1);function U(e){let t=0,n=T-1;return s.stuckAtBoundary&&(t+=M/x,n-=(1-x-M)/x),_(e,t,n)}const[{position:V},W]=h((()=>({position:100*U(N),config:{tension:200,friction:30},onRest:()=>{if(D.current)return;if(!n)return;const e=V.get(),t=C(e,100*T);t!==e&&W.start({position:t,immediate:!0})}})),[T]),$=e.useRef(null);const G=v((e=>{if($.current=e.cancel,!e.intentional)return;if(e.first&&!S&&(S=f),S!==f)return;S=e.last?void 0:f;const t=d();if(!t)return;const n=j?1:0,o=e.offset[n],s=e.direction[n],a=e.velocity[n];if(q(!0),e.last){const e=Math.floor(o/t),n=e+1,r=Math.round((o+2e3*a*s)/t);J(_(r,e,n)),window.setTimeout((()=>{q(!1)}))}else W.start({position:100*o/t,immediate:!0})}),{transform:([e,t])=>[-e,-t],from:()=>{const e=d();return[V.get()/100*e,V.get()/100*e]},triggerAllEvents:!0,bounds:()=>{if(n)return{};const e=d(),t=U(0)*e,o=U(T-1)*e;return j?{top:t,bottom:o}:{left:t,right:o}},rubberband:s.rubberband,axis:j?"y":"x",preventScroll:!j,pointer:{touch:!0}});function J(e,t=!1){var o;const a=Math.round(e),r=n?C(a,T):_(a,0,T-1);r!==I()&&(null===(o=s.onIndexChange)||void 0===o||o.call(s,r)),E(r),W.start({position:100*(n?a:U(a)),immediate:t})}function K(){J(Math.round(V.get()/100)+1)}function Q(){J(Math.round(V.get()/100)-1)}e.useImperativeHandle(o,(()=>({swipeTo:J,swipeNext:K,swipePrev:Q}))),y((()=>{const e=T-1;N>e&&J(e,!0)}));const{autoplay:X,autoplayInterval:Y}=s,Z=()=>{p.current=window.setTimeout((()=>{"reverse"===X?Q():K(),Z()}),Y)};function ee(e,o){let s={};return n&&(s={[j?"y":"x"]:V.to((t=>{let n=100*e-t;const o=100*T,s=o/2;return n=C(n+s,o)-s,"".concat(n,"%")})),[j?"top":"left"]:"-".concat(100*e,"%")}),t.createElement(g.div,{className:c("".concat(k,"-slide"),{["".concat(k,"-slide-active")]:N===e}),style:s,key:e},o)}function te(){if(O&&l){const e=2,n=Math.max(N-e,0),o=Math.min(N+e,l-1),s=[];for(let t=n;t<=o;t+=1)s.push(ee(t,O(t)));return t.createElement(t.Fragment,null,t.createElement("div",{className:"".concat(k,"-slide-placeholder"),style:{width:"".concat(100*n,"%")}}),s)}return t.Children.map(R,((e,t)=>ee(t,e)))}e.useEffect((()=>{if(X&&!H)return Z(),()=>{p.current&&window.clearTimeout(p.current)}}),[X,Y,H,T]);const ne={"--slide-size":"".concat(s.slideSize,"%"),"--track-offset":"".concat(s.trackOffset,"%")},oe=Object.assign({},s.allowTouchMove?G():{}),se={};for(const e of s.stopPropagation){se[z[e]]=function(e){e.stopPropagation()}}const ae=function(e,t){const n=Object.keys(e),o=Object.keys(t),s=new Set([...n,...o]),a={};return s.forEach((n=>{const o=e[n],s=t[n];a[n]="function"==typeof o&&"function"==typeof s?function(...e){o(...e),s(...e)}:o||s})),a}(oe,se);let re=null;return"function"==typeof m?re=m(T,N):!1!==m&&(re=t.createElement("div",{className:"".concat(k,"-indicator")},t.createElement(w,Object.assign({},s.indicatorProps,{total:T,current:N,direction:a})))),i(s,t.createElement("div",{className:c(k,"".concat(k,"-").concat(a)),style:ne},t.createElement("div",Object.assign({ref:r,className:c("".concat(k,"-track"),{["".concat(k,"-track-allow-touch-move")]:s.allowTouchMove}),onClickCapture:e=>{D.current&&e.stopPropagation(),function(){var e;null===(e=$.current)||void 0===e||e.call($),D.current=!1}()}},ae),n?t.createElement("div",{className:"".concat(k,"-track-inner")},te()):t.createElement(g.div,{className:"".concat(k,"-track-inner"),style:{[j?"y":"x"]:V.to((e=>"".concat(-e,"%")))}},te())),re))}}))),{Item:N}),R=e=>{const{itemList:t=[]}=e;return n.jsx(M,{indicator:()=>null,style:{"--border-radius":"16px"},autoplay:!0,loop:!0,children:t.map(((e,t)=>n.jsx(M.Item,{children:n.jsx("div",{children:n.jsx(f,{height:150,lazy:!0,src:e.img})})},t)))})},I="_banner_1b2z0_1",O="_coin_icon_1b2z0_4",T="_row_1b2z0_7",P="_name_1b2z0_14",A="_bottom_content_1b2z0_18",L="_red_envelope_container_1b2z0_29",B="_red_envelope_text_1b2z0_38",F="_red_envelope_send_btn_1b2z0_51",{getCarousel:H,getBoutiqueList:q,getRecommendList:D}=s("home"),{setShopNum:U}=a("common"),V=o((e=>e.common),{setShopNum:U})((()=>{const[t,o]=e.useState(!0),[s,a]=e.useState(!1),[r,c]=e.useState([]),[i,u]=e.useState([]),[d,m]=e.useState([]),[h,v]=e.useState(!0);e.useEffect((()=>{o(!0),a(!1),g(),_(),b()}),[]);const g=async()=>{const[e]=await H();2e4===(null==e?void 0:e.code)&&c(null==e?void 0:e.data)},_=async()=>{const[e]=await q();2e4===(null==e?void 0:e.code)&&u(null==e?void 0:e.data)},b=async e=>{if(s)return;const[t]=await D().finally((()=>{o(!1)})),{code:n,data:r=[]}=t;if(2e4===n&&r){m(r),v(!(d.length>=50))}a(!1)};return n.jsxs("div",{className:"warp",children:[n.jsxs("div",{className:T,children:[n.jsx(l,{className:O,src:"https://img.yzcdn.cn/vant/cat.jpeg",style:{borderRadius:20,"--size":"32px"}}),n.jsx("span",{className:P,children:"zhang"}),n.jsx(f,{className:O,src:"src/assets/icon/icon_un_complete.png",width:32,height:32,style:{borderRadius:10}})]}),n.jsx("div",{className:I,children:r.length?n.jsx(R,{itemList:r}):""}),n.jsxs("div",{className:A,onClick:()=>{confetti({particleCount:100,spread:70,origin:{y:.6}})},children:[n.jsx("div",{className:L,children:n.jsx(f,{src:"src/assets/images/red_envelope.png",height:140})}),n.jsxs("div",{className:B,children:["发送给朋友",n.jsx("div",{className:F,children:"去 送礼"})]})]}),n.jsx("div",{className:"footer",children:n.jsx(p,{})})]})}));export{V as default};
